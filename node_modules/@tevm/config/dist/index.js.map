{"version":3,"sources":["../src/config/withDefaults.js","../src/config/mergeConfigs.js","../src/config/validateUserConfig.js","../src/foundry/loadFoundryConfig.js","../src/defineConfig.js","../src/json/loadJsonConfig.js","../src/json/loadRemappingstxt.js","../src/tsconfig/getTevmConfigFromTsConfig.js","../src/tsconfig/loadTsConfig.js","../src/loadConfig.js"],"names":["succeed","SBoolean","SString","SArray","effectTry","tap","logDebug","fail","path","flatMap","foundryConfig","config","tryEffect","InvalidRemappingsError","path3","readFileSync","catchTag","die","plugin","_a","FailedToReadConfigError","Struct","optional","Record","path4","parseJson","decodeUnknownEither","match","userConfig","all","remappingsConfig","catchTags"],"mappings":"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","file":"index.js","sourcesContent":["import { logDebug, succeed, tap } from 'effect/Effect'\n\n/**\n * The default CompilerConfig\n */\nexport const defaultConfig = {\n\tjsonAsConst: [],\n\tfoundryProject: false,\n\tremappings: {},\n\tlibs: [],\n\tdebug: false,\n\tcacheDir: '.tevm',\n}\n\n/**\n * Merges the given config with the default config into a {@link import(\"../types.js\").ResolvedCompilerConfig}\n * @param {import(\"../types.js\").CompilerConfig} config\n * @returns {import(\"effect/Effect\").Effect<import(\"../types.js\").ResolvedCompilerConfig, never, never>}\n * @example\n * ```ts\n * const userConfig = { remappings: { key1: 'value1' }, libs: ['lib1'] };\n * const resolvedConfig = withDefaults(userConfig);\n * ````\n * @internal\n */\nexport const withDefaults = (config) =>\n\tsucceed({\n\t\tjsonAsConst: (() => {\n\t\t\tif (config.jsonAsConst === undefined) {\n\t\t\t\treturn defaultConfig.jsonAsConst\n\t\t\t}\n\t\t\tif (Array.isArray(config.jsonAsConst)) {\n\t\t\t\treturn config.jsonAsConst\n\t\t\t}\n\t\t\tif (typeof config.jsonAsConst === 'string') {\n\t\t\t\treturn [config.jsonAsConst]\n\t\t\t}\n\t\t\tconsole.error('Invalid jsonAsConst value must be a string or array of strings')\n\t\t\treturn defaultConfig.jsonAsConst\n\t\t})(),\n\t\tfoundryProject: config.foundryProject ?? defaultConfig.foundryProject,\n\t\tremappings: {\n\t\t\t...defaultConfig.remappings,\n\t\t\t...config.remappings,\n\t\t},\n\t\tlibs: [...defaultConfig.libs, ...(config.libs ?? [])],\n\t\tdebug: config.debug ?? defaultConfig.debug,\n\t\tcacheDir: config.cacheDir ?? defaultConfig.cacheDir,\n\t}).pipe(\n\t\ttap((configWithDefaults) =>\n\t\t\tlogDebug(\n\t\t\t\t`withDefaults: resolved config: ${JSON.stringify({\n\t\t\t\t\toriginalConfig: config,\n\t\t\t\t\tconfigWithDefaults,\n\t\t\t\t})}`,\n\t\t\t),\n\t\t),\n\t)\n","import { succeed } from 'effect/Effect'\n\n/**\n * Merges multiple configs into a single config\n * The last config in the list takes precedence on any given property\n * @param {Array<import(\"../types.js\").CompilerConfig>} configs\n * @returns {import(\"effect/Effect\").Effect<import(\"../types.js\").CompilerConfig, never, never>}\n * @example\n * ```ts\n * import {runSync} from 'effect/Effect'\n * import {mergeConfigs} from '@tevm/config'\n * const userConfig = { remappings: { key1: 'value1' }, libs: ['lib1'] };\n * const foundryConfig = { remappings: { key2: 'value2' }, libs: ['lib2', 'lib1'], foundryProject: 'forge' };\n * const mergedConfig = runSync(mergeConfigs([userConfig, foundryConfig]));\n * ````\n * @internal\n */\nexport const mergeConfigs = (configs) =>\n\tsucceed({\n\t\tremappings: Object.fromEntries(configs.flatMap((config) => Object.entries(config.remappings ?? {}))),\n\t\tfoundryProject: configs.reverse().find((config) => config.foundryProject !== undefined)?.foundryProject,\n\t\tlibs: [...new Set(configs.flatMap((config) => config.libs ?? []))],\n\t\tdebug: configs.reverse().find((config) => config.debug !== undefined)?.debug,\n\t\tcacheDir: configs.reverse().find((config) => config.cacheDir !== undefined)?.cacheDir,\n\t})\n","import {\n\tdecodeUnknownEither,\n\tLiteral,\n\toptional,\n\tRecord,\n\tArray as SArray,\n\tBoolean as SBoolean,\n\tString as SString,\n\tStruct,\n\tUndefined,\n\tUnion,\n} from '@effect/schema/Schema'\nimport { formatErrorSync } from '@effect/schema/TreeFormatter'\nimport { pipe } from 'effect'\nimport { try as effectTry, fail, flatMap, logDebug, succeed, tap } from 'effect/Effect'\nimport { match } from 'effect/Either'\n\n/**\n * Error thrown when the user provided config factory throws\n * @internal\n */\nexport class ConfigFnThrowError extends Error {\n\t/**\n\t * @type {'ConfigFnThrowError'}\n\t */\n\t_tag = 'ConfigFnThrowError'\n\t/**\n\t * @param {object} options\n\t * @param {unknown} options.cause\n\t */\n\tconstructor(options) {\n\t\tconst message =\n\t\t\ttypeof options.cause === 'string' ? options.cause : options.cause instanceof Error ? options.cause.message : ''\n\t\tsuper(`Provided config factory threw an error: ${message}`, options)\n\t}\n}\n/**\n * TypeError thrown when the user provided config factory is incorrectly typed\n * @internal\n */\nexport class InvalidConfigError extends TypeError {\n\t/**\n\t * @type {'InvalidConfigError'}\n\t */\n\t_tag = 'InvalidConfigError'\n}\n\n/**\n * @typedef {ConfigFnThrowError | InvalidConfigError} ValidateUserConfigError\n * @internal\n */\n\n/**\n * schema for the user provided config factory\n * @internal\n */\nconst SCompilerConfig = Struct({\n\tname: optional(Union(Literal('@tevm/ts-plugin'), Undefined)),\n\tfoundryProject: optional(Union(SBoolean, SString, Undefined)),\n\tlibs: optional(Union(SArray(SString), Undefined)),\n\tremappings: optional(Union(Record({ key: SString, value: SString }), Undefined)),\n\tdebug: optional(Union(SBoolean, Undefined)),\n\tcacheDir: optional(Union(SString, Undefined)),\n\tjsonAsConst: optional(Union(SString, SArray(SString), Undefined)), // Updated property\n})\n\n/**\n * Validates a config factory is a valid config else throws\n * @param {() => import(\"../types.js\").CompilerConfig} untrustedConfigFactory\n * @returns {import('effect/Effect').Effect<import(\"../types.js\").CompilerConfig, ValidateUserConfigError, never>}\n * @throws {ConfigFnThrowError} when the user provided config factory throws\n * @throws {InvalidConfigError} when the user provided config factory is incorrectly typed\n * @internal\n */\nexport const validateUserConfig = (untrustedConfigFactory) => {\n\treturn pipe(\n\t\teffectTry({\n\t\t\ttry: untrustedConfigFactory,\n\t\t\tcatch: (cause) =>\n\t\t\t\tnew ConfigFnThrowError({\n\t\t\t\t\tcause,\n\t\t\t\t}),\n\t\t}),\n\t\tflatMap((unvalidatedConfig) => {\n\t\t\tconst res = decodeUnknownEither(SCompilerConfig)(unvalidatedConfig, {\n\t\t\t\terrors: 'all',\n\t\t\t\tonExcessProperty: 'error',\n\t\t\t})\n\t\t\treturn match(res, {\n\t\t\t\tonLeft: (left) => fail(new InvalidConfigError(formatErrorSync(left), { cause: left })),\n\t\t\t\tonRight: (right) => succeed(right),\n\t\t\t})\n\t\t}),\n\t\ttap((validatedConfig) =>\n\t\t\tlogDebug(`validatedConfig: Validated config successfully: ${JSON.stringify(validatedConfig)}`),\n\t\t),\n\t)\n}\n","// TODO would be nice to break this up into composable effects\nimport { execSync } from 'node:child_process'\nimport * as path from 'node:path'\nimport { fail, logDebug, succeed, tap } from 'effect/Effect'\n\n/**\n * Error thrown if foundry is not found in path while foundryProject is set in config\n * @internal\n */\nexport class FoundryNotFoundError extends Error {\n\t/**\n\t * @type {'FoundryNotFoundError'}\n\t */\n\t_tag = 'FoundryNotFoundError'\n\t/**\n\t * @param {string} forgeCommand\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(forgeCommand, options) {\n\t\tsuper(\n\t\t\t`Failed to resolve forge config using \"${forgeCommand} config --json\" command. Make sure forge is installed and accessible and forge config --json works.\nnote: forge is used to fetch remappings only if forgeConfig is set. If you would prefer to not use forge you can set remappings\nor lib directly in your Tevm compiler config and then Tevm will run without forge`,\n\t\t\toptions,\n\t\t)\n\t}\n}\n\n/**\n * Error thrown if parsing the foundry config with `forge config` fails\n * @internal\n */\nexport class FoundryConfigError extends Error {\n\t/**\n\t * @type {'FoundryConfigError'}\n\t */\n\t_tag = 'FoundryConfigError'\n\t/**\n\t * @param {string} forgeCommand\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(forgeCommand, options) {\n\t\tsuper(`Unable to resolve foundry config using ${forgeCommand} config --json`, options)\n\t}\n}\n\n/**\n * Error thrown if foundry remappings cannot be parsed while foundryProject is set\n * @internal\n */\nexport class InvalidRemappingsError extends Error {\n\t/**\n\t * @type {'InvalidRemappingsError'}\n\t */\n\t_tag = 'InvalidRemappingsError'\n\t/**\n\t * @param {string} remappings\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(remappings, options) {\n\t\tsuper(`Invalid remappings: ${remappings}`, options)\n\t}\n}\n\n/**\n * @typedef {FoundryNotFoundError | FoundryConfigError | InvalidRemappingsError} LoadFoundryConfigError\n * @internal\n */\n\n/**\n * Loads the foundry config options if foundryProject is set so it can later be merged into the resolved config\n * Parses default options derived from foundry config if foundryProject is set\n * @param {string|boolean|undefined} foundryProject\n * @param {string} configFilePath\n * @returns {import('effect/Effect').Effect<import('../types.js').CompilerConfig, LoadFoundryConfigError, never>}\n */\nexport const loadFoundryConfig = (foundryProject, configFilePath) => {\n\tif (!foundryProject) {\n\t\treturn tap(succeed({}), () => logDebug('loadFoundryConfig: skipping because foundryProject is not set'))\n\t}\n\n\tconst forgeCommand = typeof foundryProject === 'string' ? foundryProject : 'forge'\n\tlet stdout\n\ttry {\n\t\tstdout = execSync(`${forgeCommand} config --json`, {\n\t\t\tcwd: configFilePath,\n\t\t}).toString()\n\t} catch (cause) {\n\t\tconsole.error(cause)\n\t\treturn fail(new FoundryNotFoundError(forgeCommand, { cause }))\n\t}\n\tlet forgeConfig\n\ttry {\n\t\tforgeConfig = JSON.parse(stdout)\n\t} catch (cause) {\n\t\tconsole.error(cause)\n\t\treturn fail(new FoundryConfigError(forgeCommand, { cause }))\n\t}\n\n\t/**\n\t * @type {Record<string, string>}\n\t * @internal\n\t */\n\tconst remappings = {}\n\tif (forgeConfig.remappings) {\n\t\tfor (const remap of forgeConfig.remappings) {\n\t\t\tconst parts = remap.split('=')\n\t\t\tif (parts.length !== 2) {\n\t\t\t\treturn fail(new InvalidRemappingsError(remap))\n\t\t\t}\n\t\t\tconst [key, value] = parts\n\t\t\tremappings[key.trim()] = path.join(configFilePath, value.trim())\n\t\t}\n\t}\n\n\treturn tap(\n\t\tsucceed({\n\t\t\tlibs: forgeConfig?.libs,\n\t\t\tremappings: remappings,\n\t\t}),\n\t\t(config) => {\n\t\t\treturn logDebug(\n\t\t\t\t`loadFoundryConfig: foundryProject is set, loading foundry config as an Tevm CompilerConfig: ${JSON.stringify(\n\t\t\t\t\tconfig,\n\t\t\t\t)}`,\n\t\t\t)\n\t\t},\n\t)\n}\n","import { all, catchTags, fail, flatMap, logDebug, tap } from 'effect/Effect'\nimport { mergeConfigs, validateUserConfig, withDefaults } from './config/index.js'\nimport { loadFoundryConfig } from './foundry/index.js'\n\n/**\n * Error class for {@link defineConfig}\n */\nexport class DefineConfigError extends Error {\n\t/**\n\t * @type {import(\"./types.js\").DefineConfigErrorType['_tag']}\n\t * @override\n\t */\n\tname\n\t/**\n\t * @type {import(\"./types.js\").DefineConfigErrorType['_tag']}\n\t **/\n\t_tag\n\t/**\n\t * @param {string} configFilePath\n\t * @param {import(\"./types.js\").DefineConfigErrorType} underlyingError\n\t **/\n\tconstructor(configFilePath, underlyingError) {\n\t\tsuper(\n\t\t\t`${underlyingError._tag}: Unable to resolve Tevm CompilerConfig at ${configFilePath}\n${underlyingError.message}`,\n\t\t\t{ cause: underlyingError.cause },\n\t\t)\n\t\tthis._tag = underlyingError._tag\n\t\tthis.name = underlyingError._tag\n\t}\n}\n\n/**\n * Typesafe way to create an Tevm CompilerConfig\n * @type {import(\"./types.js\").DefineConfig}\n * @example\n * ```ts\n * import { defineConfig } from '@tevm/ts-plugin'\n *\n * export default defineConfig(() => ({\n * \tlib: ['lib'],\n * \tremappings: {\n * \t  'foo': 'foo/bar'\n * \t}\n * })\n * ```\n */\nexport const defineConfig = (configFactory) => ({\n\tconfigFn: (configFilePath) => {\n\t\tconst config = validateUserConfig(configFactory)\n\t\tconst foundryConfig = flatMap(config, ({ foundryProject }) => loadFoundryConfig(foundryProject, configFilePath))\n\t\t/**\n\t\t * @param {import(\"./types.js\").DefineConfigErrorType} error\n\t\t * @returns {import(\"effect/Effect\").Effect<never, DefineConfigError, never>}\n\t\t */\n\t\tconst handleError = (error) => {\n\t\t\treturn fail(new DefineConfigError(configFilePath, error))\n\t\t}\n\t\treturn all([config, foundryConfig]).pipe(\n\t\t\ttap(([userConfig, foundryConfig]) =>\n\t\t\t\tlogDebug(\n\t\t\t\t\t`defineConfig: Config read CompilerConfigs ${JSON.stringify({\n\t\t\t\t\t\tuserConfig,\n\t\t\t\t\t\tfoundryConfig,\n\t\t\t\t\t})}`,\n\t\t\t\t),\n\t\t\t),\n\t\t\tflatMap(mergeConfigs),\n\t\t\ttap((mergedConfigs) => logDebug(`defineConfig: MergedConfigs ${JSON.stringify({ mergedConfigs })}`)),\n\t\t\tflatMap(withDefaults),\n\t\t\tcatchTags({\n\t\t\t\tInvalidRemappingsError: handleError,\n\t\t\t\tInvalidConfigError: handleError,\n\t\t\t\tFoundryNotFoundError: handleError,\n\t\t\t\tFoundryConfigError: handleError,\n\t\t\t\tConfigFnThrowError: handleError,\n\t\t\t}),\n\t\t\ttap((config) =>\n\t\t\t\tlogDebug(\n\t\t\t\t\t`defineConfig: Added defaults. Config read ${JSON.stringify({\n\t\t\t\t\t\tconfig,\n\t\t\t\t\t})}`,\n\t\t\t\t),\n\t\t\t),\n\t\t)\n\t},\n})\n","import { readFileSync } from 'node:fs'\nimport * as path from 'node:path'\nimport { parseJson } from '@tevm/effect'\nimport { catchTag, die, fail, flatMap, logDebug, tap, try as tryEffect } from 'effect/Effect'\nimport { InvalidConfigError, validateUserConfig } from '../config/validateUserConfig.js'\n\nexport class FailedToReadConfigError extends Error {\n\t/**\n\t * @type {'FailedToReadConfigError'}\n\t */\n\t_tag = 'FailedToReadConfigError'\n\t/**\n\t * @param {string} configFilePath\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(configFilePath, options) {\n\t\tsuper(`Failed to find tevm.config.json ${configFilePath}`, options)\n\t}\n}\n\n/**\n * TypeError thrown when the user provided config factory is incorrectly typed\n * @internal\n */\nexport class InvalidJsonConfigError extends TypeError {\n\t/**\n\t * @type {'InvalidJsonConfigError'}\n\t * @override\n\t */\n\tname = 'InvalidJsonConfigError'\n\t/**\n\t * @type {'InvalidJsonConfigError'}\n\t */\n\t_tag = 'InvalidJsonConfigError'\n\t/**\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(options) {\n\t\tsuper('Invalid json detected', options)\n\t}\n}\n\n/**\n * @typedef {import(\"@tevm/effect\").ParseJsonError | FailedToReadConfigError | InvalidJsonConfigError | InvalidConfigError} LoadJsonConfigError\n * @internal\n */\n\n/**\n * Synchronously loads a Tevm config from the given path\n * @param {string} configFilePath\n * @returns {import(\"effect/Effect\").Effect<import('../types.js').CompilerConfig, LoadJsonConfigError, never>} the contents of the tsconfig.json file\n * @internal\n */\nexport const loadJsonConfig = (configFilePath) => {\n\tconst tevmConfigPath0 = path.join(configFilePath, 'tevm.config.json')\n\tconst tevmConfigPath1 = path.join(configFilePath, 'tevm.json')\n\t/**\n\t * @param {string} configPath\n\t */\n\tconst readConfig = (configPath) =>\n\t\ttryEffect({\n\t\t\ttry: () => readFileSync(configPath, 'utf8'),\n\t\t\tcatch: (cause) => new FailedToReadConfigError(configFilePath, { cause }),\n\t\t})\n\treturn readConfig(tevmConfigPath0).pipe(\n\t\tcatchTag('FailedToReadConfigError', () => {\n\t\t\treturn readConfig(tevmConfigPath1)\n\t\t}),\n\t\tflatMap(parseJson),\n\t\tcatchTag('ParseJsonError', (cause) => fail(new InvalidJsonConfigError({ cause }))),\n\t\tflatMap((cfg) => validateUserConfig(() => /** @type {import('../types.js').CompilerConfig}*/ (cfg))),\n\t\t// it can't throw. Could clean this up via making validateUserConfig take a config instead of a factory\n\t\tcatchTag('ConfigFnThrowError', (e) => die(e)),\n\t\ttap((tsConfig) => logDebug(`loading tsconfig from ${configFilePath}: ${JSON.stringify(tsConfig)}`)),\n\t)\n}\n","import { readFileSync } from 'node:fs'\nimport * as path from 'node:path'\nimport { catchTag, die, fail, flatMap, logDebug, succeed, tap, try as tryEffect } from 'effect/Effect'\nimport { validateUserConfig } from '../config/validateUserConfig.js'\n\n/**\n * TypeError thrown when the user provided remappings is not properly formatted\n * @internal\n */\nexport class InvalidRemappingsError extends TypeError {\n\t/**\n\t * @type {'InvalidRemappingsError'}\n\t * @override\n\t */\n\tname = 'InvalidRemappingsError'\n\t/**\n\t * @type {'InvalidRemappingsError'}\n\t */\n\t_tag = 'InvalidRemappingsError'\n}\n\n/**\n * @typedef {InvalidRemappingsError } LoadRemappingsError\n * @internal\n */\n\n/**\n * Synchronously loads a Tevm config from the given path\n * @param {string} configFilePath\n * @returns {import(\"effect/Effect\").Effect<import('../types.js').CompilerConfig, LoadRemappingsError, never>} the contents of the tsconfig.json file\n * @internal\n */\nexport const loadRemappings = (configFilePath) => {\n\tconst remappingsPath = path.join(configFilePath, 'remappings.txt')\n\t/**\n\t * @param {string} configPath\n\t */\n\tconst readConfig = (configPath) =>\n\t\ttryEffect({\n\t\t\ttry: () => readFileSync(configPath, 'utf8'),\n\t\t\tcatch: () => new InvalidRemappingsError('No remapping file exists'),\n\t\t})\n\treturn readConfig(remappingsPath).pipe(\n\t\t// if remappings doesn't exist that's fine just return nothing\n\t\tcatchTag('InvalidRemappingsError', () => {\n\t\t\treturn succeed('')\n\t\t}),\n\t\tflatMap((remappings) => {\n\t\t\tif (remappings.trim() === '') {\n\t\t\t\treturn succeed({})\n\t\t\t}\n\t\t\tconst remappingEntries = remappings.trim().split('\\n')\n\n\t\t\t// validate remappings\n\t\t\tfor (const remapping of remappingEntries) {\n\t\t\t\tif (remapping.trim() === '') {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst remappingArr = remapping.split('=')\n\t\t\t\tif (remappingArr.length !== 2) {\n\t\t\t\t\treturn fail(\n\t\t\t\t\t\tnew InvalidRemappingsError(\n\t\t\t\t\t\t\t`Invalid remapping ${remapping}. Remapping in remapping.txt should look like @solmate-utils/=lib/solmate/src/utils/`,\n\t\t\t\t\t\t),\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Turn remappings into a tevm config shape\n\t\t\t/**\n\t\t\t * @type {import('../types.js').CompilerConfig}\n\t\t\t */\n\t\t\tconst config = {\n\t\t\t\tremappings: Object.fromEntries(\n\t\t\t\t\tremappingEntries.map((remapping) => {\n\t\t\t\t\t\tconst [from, to] = remapping.trim().split('=')\n\t\t\t\t\t\t// TODO this line of code won't work on windows\n\t\t\t\t\t\treturn /** @type {[string, string]}*/ ([\n\t\t\t\t\t\t\tfrom,\n\t\t\t\t\t\t\t`${configFilePath.endsWith('/') ? configFilePath : `${configFilePath}/`}${to?.startsWith('/') ? to.slice(1) : to}`,\n\t\t\t\t\t\t])\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t}\n\t\t\treturn succeed(config)\n\t\t}),\n\t\tflatMap((cfg) => validateUserConfig(() => /** @type {import('../types.js').CompilerConfig}*/ (cfg))),\n\t\t// it can't thrw. Could clean this up via making validateUserConfig take a config instead of a factory\n\t\tcatchTag('ConfigFnThrowError', (e) => die(e)),\n\t\t// internal error if this happens\n\t\tcatchTag('InvalidConfigError', (e) => die(e)),\n\t\ttap((normalizedConfig) =>\n\t\t\tlogDebug(`loading remappings from ${configFilePath}: ${JSON.stringify(normalizedConfig)}`),\n\t\t),\n\t)\n}\n","import { catchTag, die, fail, logDebug, map, tap } from 'effect/Effect'\nimport { validateUserConfig } from '../config/index.js'\n\n/**\n * Error type for {@link getTevmConfigFromTsConfig}\n * @internal\n */\nexport class NoPluginInTsConfigFoundError extends Error {\n\t/**\n\t * @type {'NoPluginInTsConfigFoundError'}\n\t */\n\t_tag = 'NoPluginInTsConfigFoundError'\n}\n\n/**\n * @typedef {NoPluginInTsConfigFoundError | import(\"../config/index.js\").InvalidConfigError } GetTevmConfigFromTsConfigError\n */\n\n/**\n * @param {import(\"./loadTsConfig.js\").TsConfig} tsConfig\n * @param {string} configPath`\n * @returns {import(\"effect/Effect\").Effect<import(\"../types.js\").CompilerConfig, GetTevmConfigFromTsConfigError, never>}\n * @internal\n */\nexport const getTevmConfigFromTsConfig = (tsConfig, configPath) => {\n\tif (!tsConfig.compilerOptions?.plugins?.length) {\n\t\treturn fail(new NoPluginInTsConfigFoundError('No compilerOptions.plugins in tsconfig'))\n\t}\n\tconst plugin =\n\t\t/**\n\t\t * @type {import(\"../types.js\").CompilerConfig | undefined}\n\t\t */\n\t\t(tsConfig.compilerOptions.plugins.find((/** @type {any}*/ plugin) => plugin.name === '@tevm/ts-plugin'))\n\tif (!plugin) {\n\t\treturn fail(new NoPluginInTsConfigFoundError())\n\t}\n\tconst { baseUrl, paths } = tsConfig.compilerOptions\n\tconst pathRemappings = Object.fromEntries(\n\t\tObject.entries(paths ?? {}).map(([key, value]) => [\n\t\t\tkey.replace(/\\/\\*$/, '/'),\n\t\t\tvalue?.[0]?.replace(/^\\./, configPath).replace(/\\/\\*$/, '/') ?? '',\n\t\t]),\n\t)\n\treturn validateUserConfig(() => plugin).pipe(\n\t\tcatchTag('ConfigFnThrowError', (e) => die(e)),\n\t\tmap((config) => ({\n\t\t\t...config,\n\t\t\tremappings: {\n\t\t\t\t...config.remappings,\n\t\t\t\t...pathRemappings,\n\t\t\t},\n\t\t})),\n\t\tmap((config) =>\n\t\t\tbaseUrl\n\t\t\t\t? {\n\t\t\t\t\t\t...config,\n\t\t\t\t\t\tremappings: {\n\t\t\t\t\t\t\t...pathRemappings,\n\t\t\t\t\t\t\t...config.remappings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlibs: [...new Set([baseUrl, ...(config.libs ?? [])])],\n\t\t\t\t\t}\n\t\t\t\t: config,\n\t\t),\n\t\ttap((config) => {\n\t\t\treturn logDebug(`getting config from tsconfig:\n  tsconfig: ${JSON.stringify(config)}\n  result: ${JSON.stringify(config)}`)\n\t\t}),\n\t)\n}\n","import { existsSync, readFileSync, writeFileSync } from 'node:fs'\nimport * as path from 'node:path'\nimport {\n\tdecodeUnknownEither,\n\toptional,\n\tRecord,\n\tArray as SArray,\n\tString as SString,\n\tStruct,\n} from '@effect/schema/Schema'\nimport { parseJson } from '@tevm/effect'\nimport { catchTag, fail, flatMap, logDebug, succeed, tap, tapBoth, try as tryEffect } from 'effect/Effect'\nimport { match } from 'effect/Either'\n\n/**\n * Expected shape of tsconfig.json or jsconfig.json\n * @typedef {{ compilerOptions?: { plugins?: ReadonlyArray<{ name: string }> | undefined, baseUrl?: string | undefined, paths?: Record<string, ReadonlyArray<string>> | undefined } | undefined }} TsConfig\n * @internal\n */\n\nexport class FailedToReadConfigError extends Error {\n\t/**\n\t * @type {'FailedToReadConfigError'}\n\t */\n\t_tag = 'FailedToReadConfigError'\n\t/**\n\t * @param {string} configFilePath\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(configFilePath, options) {\n\t\tsuper(`Failed to find ${configFilePath}/tsconfig.json`, options)\n\t}\n}\n\n/**\n * TypeError thrown when the user provided config factory is incorrectly typed\n * @internal\n */\nexport class InvalidTsConfigError extends TypeError {\n\t/**\n\t * @type {'InvalidConfigError'}\n\t */\n\t_tag = 'InvalidConfigError'\n\t/**\n\t * @param {object} [options]\n\t * @param {unknown} [options.cause]\n\t */\n\tconstructor(options) {\n\t\tsuper('Invalid tsconfig.json detected', options)\n\t}\n}\n\n/**\n * schema for tsconfig shape with plugin\n * @internal\n */\nconst STsConfigWithPlugin = Struct({\n\tcompilerOptions: Struct({\n\t\tbaseUrl: optional(SString),\n\t\tplugins: SArray(\n\t\t\tStruct({\n\t\t\t\tname: SString,\n\t\t\t}),\n\t\t),\n\t\tpaths: optional(Record({ key: SString, value: SArray(SString) })),\n\t}),\n})\n/**\n * schema for tsconfig shape\n * @internal\n */\nconst STsConfig = Struct({\n\tcompilerOptions: Struct({\n\t\tbaseUrl: optional(SString),\n\t\tplugins: optional(\n\t\t\tSArray(\n\t\t\t\tStruct({\n\t\t\t\t\tname: SString,\n\t\t\t\t}),\n\t\t\t),\n\t\t),\n\t\tpaths: optional(Record({ key: SString, value: SArray(SString) })),\n\t}),\n})\n\n/**\n * @typedef {import(\"@tevm/effect\").ParseJsonError | FailedToReadConfigError | InvalidTsConfigError} LoadTsConfigError\n * @internal\n */\n\n/**\n * Syncronously loads an Tevm config from the given path\n * @param {string} configFilePath\n * @returns {import(\"effect/Effect\").Effect<TsConfig, LoadTsConfigError, never>} the contents of the tsconfig.json file\n * @internal\n */\nexport const loadTsConfig = (configFilePath) => {\n\tconst tsConfigPath = path.join(configFilePath, 'tsconfig.json')\n\tconst jsConfigPath = path.join(configFilePath, 'jsconfig.json')\n\n\treturn tryEffect({\n\t\ttry: () => (existsSync(jsConfigPath) ? readFileSync(jsConfigPath, 'utf8') : readFileSync(tsConfigPath, 'utf8')),\n\t\tcatch: (cause) => new FailedToReadConfigError(configFilePath, { cause }),\n\t}).pipe(\n\t\t// parse the json\n\t\tflatMap(parseJson),\n\t\t// parse the tsconfig without plugins\n\t\tflatMap((unvalidatedConfig) => {\n\t\t\tconst res = decodeUnknownEither(STsConfig)(unvalidatedConfig, {\n\t\t\t\terrors: 'all',\n\t\t\t\tonExcessProperty: 'ignore',\n\t\t\t})\n\t\t\treturn match(res, {\n\t\t\t\tonLeft: (left) => fail(new InvalidTsConfigError({ cause: left })),\n\t\t\t\tonRight: (right) => succeed(right),\n\t\t\t})\n\t\t}),\n\t\t// add ts-plugin if it's missing\n\t\ttap((unvalidatedConfig) =>\n\t\t\t// if it doesn't have the plugin automatically install\n\t\t\tdecodeUnknownEither(STsConfigWithPlugin)(unvalidatedConfig, {\n\t\t\t\terrors: 'all',\n\t\t\t\tonExcessProperty: 'ignore',\n\t\t\t}).pipe(\n\t\t\t\ttapBoth({\n\t\t\t\t\tonFailure: () => {\n\t\t\t\t\t\tconst newConfig = {\n\t\t\t\t\t\t\t...unvalidatedConfig,\n\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t...unvalidatedConfig.compilerOptions,\n\t\t\t\t\t\t\t\tplugins: [{ name: '@tevm/ts-plugin' }],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst path = existsSync(jsConfigPath) ? jsConfigPath : tsConfigPath\n\t\t\t\t\t\t\twriteFileSync(path, JSON.stringify(newConfig, null, 2))\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tconsole.error(e)\n\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\t'Missing @tevm/ts-plugin in tsconfig.json and unable to add it automatically. Please add it manually.',\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn succeed(newConfig)\n\t\t\t\t\t},\n\t\t\t\t\tonSuccess: (config) => {\n\t\t\t\t\t\tconst hasPlugin = config.compilerOptions.plugins.some((plugin) => plugin.name === '@tevm/ts-plugin')\n\t\t\t\t\t\tif (!hasPlugin) {\n\t\t\t\t\t\t\tconst newConfig = {\n\t\t\t\t\t\t\t\t...config,\n\t\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t\t...config.compilerOptions,\n\t\t\t\t\t\t\t\t\tplugins: [{ name: '@tevm/ts-plugin' }, ...config.compilerOptions.plugins],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst path = existsSync(jsConfigPath) ? jsConfigPath : tsConfigPath\n\t\t\t\t\t\t\t\twriteFileSync(path, JSON.stringify(newConfig, null, 2))\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.error(e)\n\t\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\t\t'Missing @tevm/ts-plugin in tsconfig.json and unable to add it automatically. Please add it manually.',\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn succeed(newConfig)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn succeed(config)\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t),\n\t\t),\n\t\tflatMap((unvalidatedConfig) => {\n\t\t\tconst res = decodeUnknownEither(STsConfigWithPlugin)(unvalidatedConfig, {\n\t\t\t\terrors: 'all',\n\t\t\t\tonExcessProperty: 'ignore',\n\t\t\t})\n\t\t\treturn match(res, {\n\t\t\t\tonLeft: (left) => fail(new InvalidTsConfigError({ cause: left })),\n\t\t\t\tonRight: (right) => succeed(right),\n\t\t\t})\n\t\t}),\n\t\tcatchTag('ParseError', (cause) => fail(new InvalidTsConfigError({ cause }))),\n\t\ttap((tsConfig) => logDebug(`loading tsconfig from ${configFilePath}: ${JSON.stringify(tsConfig)}`)),\n\t)\n}\n","import { logAllErrors } from '@tevm/effect'\nimport { all, catchTag, catchTags, fail, flatMap, logDebug, tap, tapError } from 'effect/Effect'\nimport { mergeConfigs, withDefaults } from './config/index.js'\nimport { loadFoundryConfig } from './foundry/index.js'\nimport { InvalidJsonConfigError, loadJsonConfig } from './json/loadJsonConfig.js'\nimport { loadRemappings } from './json/loadRemappingstxt.js'\nimport { getTevmConfigFromTsConfig, loadTsConfig } from './tsconfig/index.js'\n\n/**\n * @typedef {import(\"./tsconfig/index.js\").LoadTsConfigError | import(\"./tsconfig/index.js\").GetTevmConfigFromTsConfigError | import(\"./foundry/index.js\").LoadFoundryConfigError | InvalidJsonConfigError} LoadConfigErrorType\n */\n\n/**\n * Error class for {@link loadConfig}\n */\nexport class LoadConfigError extends Error {\n\t/**\n\t * @type {LoadConfigError['_tag']}\n\t * @override\n\t */\n\tname\n\t/**\n\t * @type {LoadConfigErrorType['_tag']}\n\t **/\n\t_tag\n\t/**\n\t * @param {string} configFilePath\n\t * @param {LoadConfigErrorType} underlyingError\n\t **/\n\tconstructor(configFilePath, underlyingError) {\n\t\tsuper(\n\t\t\t`${underlyingError._tag}: Unable load config from ${configFilePath}\n${underlyingError.message}`,\n\t\t\t{ cause: underlyingError.cause },\n\t\t)\n\t\tthis._tag = underlyingError._tag\n\t\tthis.name = underlyingError._tag\n\t}\n}\n\n/**\n * Loads an Tevm config from the given path\n * @param {string} configFilePath\n * @returns {import(\"effect/Effect\").Effect<import(\"./types.js\").ResolvedCompilerConfig, LoadConfigError, never>}\n * @example\n * ```ts\n * import {tap} from 'effect/Effect'\n * import {loadConfig} from '@tevm/config'\n *\n * runPromise(loadConfig('./tsconfig.json')).pipe(\n *   tap(config => console.log(config))\n * )\n * ```\n */\nexport const loadConfig = (configFilePath) => {\n\tconst userConfig = logDebug(`loadConfig: loading userConfig at ${JSON.stringify(configFilePath)}`).pipe(\n\t\tflatMap(() => loadJsonConfig(configFilePath)),\n\t\tcatchTag('FailedToReadConfigError', (e) =>\n\t\t\tlogDebug(`loadConfig: loading tsConfig at ${JSON.stringify(configFilePath)}`)\n\t\t\t\t.pipe(flatMap(() => loadTsConfig(configFilePath)))\n\t\t\t\t.pipe(\n\t\t\t\t\tflatMap((tsConfig) => getTevmConfigFromTsConfig(tsConfig, configFilePath)),\n\t\t\t\t\tcatchTag('NoPluginInTsConfigFoundError', () => fail(e)),\n\t\t\t\t\tcatchTag('FailedToReadConfigError', () => fail(e)),\n\t\t\t\t),\n\t\t),\n\t)\n\tconst foundryConfig = flatMap(userConfig, (userConfig) => {\n\t\treturn loadFoundryConfig(userConfig.foundryProject, configFilePath)\n\t})\n\tconst remappingsConfig = loadRemappings(configFilePath)\n\t/**\n\t * @param {LoadConfigErrorType} error\n\t * @returns {import(\"effect/Effect\").Effect<never, LoadConfigError, never>}\n\t */\n\tconst handleError = (error) => {\n\t\treturn fail(new LoadConfigError(configFilePath, error))\n\t}\n\treturn all([userConfig, foundryConfig, remappingsConfig]).pipe(\n\t\ttap(([userConfig, foundryConfig, remappingsConfig]) =>\n\t\t\tlogDebug(\n\t\t\t\t`loadConfig: Config read CompilerConfigs ${JSON.stringify({\n\t\t\t\t\tuserConfig,\n\t\t\t\t\tfoundryConfig,\n\t\t\t\t\tremappingsConfig,\n\t\t\t\t})}`,\n\t\t\t),\n\t\t),\n\t\tflatMap(mergeConfigs),\n\t\ttap((mergedConfigs) =>\n\t\t\tlogDebug(\n\t\t\t\t`loadConfig: Config read CompilerConfigs ${JSON.stringify({\n\t\t\t\t\tmergedConfigs,\n\t\t\t\t})}`,\n\t\t\t),\n\t\t),\n\t\tflatMap(withDefaults),\n\t\ttapError(logAllErrors),\n\t\tcatchTags({\n\t\t\tFailedToReadConfigError: handleError,\n\t\t\tFoundryConfigError: handleError,\n\t\t\tFoundryNotFoundError: handleError,\n\t\t\tInvalidConfigError: handleError,\n\t\t\tInvalidRemappingsError: handleError,\n\t\t\tParseJsonError: handleError,\n\t\t\tInvalidJsonConfigError: handleError,\n\t\t}),\n\t\ttap((config) => logDebug(`loadConfig: Config loaded ${JSON.stringify({ config })}`)),\n\t)\n}\n"]}